### 用处

- 通过提供组件的任务流管理器，定向更新组件内容
- 减少重复渲染
- 避免任务重复执行
- 避免由于请求返回时间的不确定性，导致展示数据出现问题
- 记录所有当前节点的运行状态，避免用户进行过多无用的操作

- 记录节点运行状态， pending, none , error
- 链路执行冲突时的回调, 可以同来 cancel 之前的任务
- 控制数据流，用户只需要实现当前的任务细节，而不需要关心节点依赖关系，以及加载的时序问题
- 中间节点执行错误的时候，后续任务将停止执行，减少不必要的请求
- 提供快速重试的方法
- 当前组件触发任务，或者依赖的任务执行完成，才会让组件重新渲染，避免无效的渲染

### motivation

这里其实有三个模块，最长用的可能就是@alife/dependence 这个库。

这个 lib 是做什么的？

- 使用可控的单向数据流，让任务执行依赖变的更可控
- 展示逻辑与操作逻辑解耦。
- 提升页面的可控性
- 当多任务执行的时候，避免统一任务的重复执行

### 糟糕的页面表现？

> 大多数的页面糟糕都是由于 竞态问题导致的

- 比如筛选切换的时候，第一次请求比第二次请求回来的更晚？
  - 大多数情况不会出现？简单的场景，当后端做了请求缓存，我第二次请求命中的是缓存，就很可能发生这样的问题
- 当你再一小段时间内进行多次筛选的操作，你的数据请求还可控吗？
- 请求失败之后，用户没有体感？我用了错误的数据分析了半天？
- 请求失败之后，怎样重试？

### 经典的场景例子

- 联动的筛选框列表
- 图表组件间的联动

  - action

    - 图表组中的值作为其他组件的筛选条件
    - 清空选中值

  - 表现
    - 筛选后的表现
    - 没被筛选时的表现

### 报表模块的抽象

- 页面布局
  - 布局模板
  - 动态布局
    - 树形布局
      - 容器
      - 组件
    - 平铺布局
      - 组件
- 筛选 & 数据模块的联动

### feature

- 新增任务流节点例子
- 作用域的例子
- 属性展示

### 链路操作

1. 初始化图
2. 创建运行时图
3. 任务节点运行状态
4. 任务节点成功 或者 失败
5. 节点新增或者删除
6. 任务重跑

### 链路可视化

1. 存储链路数据片段
2. 提取数据片段进行展示

### 一个任务会有哪些场景

- 任务重跑(影响下游)

### 一个组件会有哪些状态

- blank
- parial
- error
- loading
- ideal

### 会有哪些交互上的行为

- 基础
  - 模块状态更新，更新下游
  - 指定作用域更新
  - 更新多个模块数据
  - 执行下游任务
- 高级

### 模块抽象

模块 = 视图数据(M) + 渲染(V) + 交互(C)
原始数据(Source data) + 业务逻辑(Business logic) => 视图数据
视图数据+ 展示逻辑(Show logic) => 模块渲染
展示逻辑(Show logic) = Blank | Partial | Error | Loading | Ideal
交互 = 视图数据变更（C => M） + 下游组件运行(Notify)

### 协作开发友好

业务页面的开发分工，可以向模块化组件一样友好。

### 交互联动场景

- 简单数据联动
- 循环联动
- 异步数据联动
- 联动触发校验
- 多维数据联动

### 作用域场景

- 查询框

### 优点

- Predictable
- Centralized
- Debuggable

### redux 借鉴

- a model update anthoer model
- a view can update a model, which updates another model, and this, in turn, might cause another view to update

### 组件的交互方式

- 模块自更新
- 模块更新并触发下游更新
- 一个组件触发一个组件刷新
- 一个组件触发多个组件变更
- 一个组件自身变化
- 组件

### 待解决问题

1. 获取非原子属性

### 校验逻辑增加实验
